
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Official Tutorial Archiveâ„¢ of NokogiriÂ®">
      
      
        <meta name="author" content="Mike Dalessio">
      
      
        <link rel="canonical" href="https://nokogiri.org/CONTRIBUTING.html">
      
      
        
      
      <link rel="icon" href="images/nokogiri-serif-black.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4+insiders-4.5.1">
    
    
      
        <title>Contributing - Nokogiri</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.f8ad3a65.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      <link rel="preload" as="style" href="assets/stylesheets/vendor/mermaid.9c0dc1da.min.css">
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CMenlo&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Menlo"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/tidelift.css">
    
      <link rel="stylesheet" href="stylesheets/custom.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-1260604-8","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){if(document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document.forms.feedback){var e,a=document.forms.feedback;for(e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Contributing - Nokogiri" >
      
        <meta  property="og:description"  content="The Official Tutorial Archiveâ„¢ of NokogiriÂ®" >
      
        <meta  property="og:image"  content="https://nokogiri.org/assets/images/social/CONTRIBUTING.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nokogiri.org/CONTRIBUTING.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Contributing - Nokogiri" >
      
        <meta  name="twitter:description"  content="The Official Tutorial Archiveâ„¢ of NokogiriÂ®" >
      
        <meta  name="twitter:image"  content="https://nokogiri.org/assets/images/social/CONTRIBUTING.png" >
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#contributing-to-nokogiri" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Nokogiri" class="md-header__button md-logo" aria-label="Nokogiri" data-md-component="logo">
      
  <img src="images/nokogiri-serif-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nokogiri
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Contributing
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sparklemotion/nokogiri" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    sparklemotion/nokogiri
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        


  
    
    
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
  Overview

      </a>
    </li>
  

      
        


  
    
    
  
  
    <li class="md-tabs__item">
      <a href="rdoc/index.html" class="md-tabs__link">
        
  
  API

      </a>
    </li>
  

      
        


  
    
    
  
  
    
    
    
      <li class="md-tabs__item">
        <a href="tutorials/installing_nokogiri.html" class="md-tabs__link">
          
  
  Support

        </a>
      </li>
    
  

      
        


  
    
    
  
  
    
    
    
      <li class="md-tabs__item">
        <a href="tutorials/toc.html" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        


  
    
    
  
  
    <li class="md-tabs__item">
      <a href="CHANGELOG.html" class="md-tabs__link">
        
  
  Changelog

      </a>
    </li>
  

      
        


  
    
    
      
    
  
  
    
    
    
      <li class="md-tabs__item">
        <a href="CONTRIBUTING.html" class="md-tabs__link md-tabs__link--active">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Nokogiri" class="md-nav__button md-logo" aria-label="Nokogiri" data-md-component="logo">
      
  <img src="images/nokogiri-serif-white.svg" alt="logo">

    </a>
    Nokogiri
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sparklemotion/nokogiri" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    sparklemotion/nokogiri
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>

      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="rdoc/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>

      </a>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          
  
  <span class="md-ellipsis">
    Support
  </span>

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Support" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Support
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/installing_nokogiri.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing Nokogiri
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tidelift-landing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nokogiri for Enterprise
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/getting_help.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Help
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/security.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/more_resources.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    More Resources
  </span>

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          
  
  <span class="md-ellipsis">
    Tutorials
  </span>

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/toc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of Contents
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/parsing_an_html_xml_document.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parsing an HTML/XML document
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/parsing_an_html5_document.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parsing an HTML5 document
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/searching_a_xml_html_document.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Searching a XML/HTML document
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/modifying_an_html_xml_document.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modifying an HTML/XML document
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/ensuring_well_formed_markup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ensuring well-formed markup
  </span>

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="CHANGELOG.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>

      </a>
    </li>
  

    
      
      
      


  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          
  
  <span class="md-ellipsis">
    About
  </span>

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Contributing
  </span>

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="CONTRIBUTING.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#contents" class="md-nav__link">
    Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-guiding-principles-of-the-project" class="md-nav__link">
    Some guiding principles of the project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-to-start-getting-involved" class="md-nav__link">
    Where to start getting involved
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-pull-requests" class="md-nav__link">
    Submitting Pull Requests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#branch-management-and-release-management" class="md-nav__link">
    Branch Management and Release Management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-your-local-development-environment" class="md-nav__link">
    How to set up your local development environment
  </a>
  
    <nav class="md-nav" aria-label="How to set up your local development environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    Basic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced" class="md-nav__link">
    Advanced
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-the-tests" class="md-nav__link">
    How to run the tests
  </a>
  
    <nav class="md-nav" aria-label="How to run the tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-short-version" class="md-nav__link">
    The short version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cruby-advanced-usage" class="md-nav__link">
    CRuby advanced usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libxml2-advanced-usage" class="md-nav__link">
    libxml2 advanced usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gumbo-html5-parser" class="md-nav__link">
    gumbo HTML5 parser
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#style-guide" class="md-nav__link">
    Style Guide
  </a>
  
    <nav class="md-nav" aria-label="Style Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-continuous-integration-ci-is-configured" class="md-nav__link">
    How Continuous Integration ("CI") is configured
  </a>
  
    <nav class="md-nav" aria-label="How Continuous Integration ("CI") is configured">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coverage" class="md-nav__link">
    Coverage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#valgrind-and-ruby_memcheck" class="md-nav__link">
    Valgrind and ruby_memcheck
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helpful-hints-when-writing-new-ci-jobs" class="md-nav__link">
    Helpful hints when writing new CI jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-releases" class="md-nav__link">
    Packaging releases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-utilities" class="md-nav__link">
    Other utilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bumping-java-dependencies" class="md-nav__link">
    Bumping Java dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rake-tasks" class="md-nav__link">
    Rake tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-release" class="md-nav__link">
    Making a release
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-of-conduct" class="md-nav__link">
    Code of Conduct
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CODE_OF_CONDUCT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of Conduct
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="SECURITY.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="LICENSE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="LICENSE-DEPENDENCIES.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ROADMAP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="privacy-policy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privacy Policy
  </span>

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#contents" class="md-nav__link">
    Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-guiding-principles-of-the-project" class="md-nav__link">
    Some guiding principles of the project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-to-start-getting-involved" class="md-nav__link">
    Where to start getting involved
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-pull-requests" class="md-nav__link">
    Submitting Pull Requests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#branch-management-and-release-management" class="md-nav__link">
    Branch Management and Release Management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-your-local-development-environment" class="md-nav__link">
    How to set up your local development environment
  </a>
  
    <nav class="md-nav" aria-label="How to set up your local development environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    Basic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced" class="md-nav__link">
    Advanced
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-the-tests" class="md-nav__link">
    How to run the tests
  </a>
  
    <nav class="md-nav" aria-label="How to run the tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-short-version" class="md-nav__link">
    The short version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cruby-advanced-usage" class="md-nav__link">
    CRuby advanced usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libxml2-advanced-usage" class="md-nav__link">
    libxml2 advanced usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gumbo-html5-parser" class="md-nav__link">
    gumbo HTML5 parser
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#style-guide" class="md-nav__link">
    Style Guide
  </a>
  
    <nav class="md-nav" aria-label="Style Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-continuous-integration-ci-is-configured" class="md-nav__link">
    How Continuous Integration ("CI") is configured
  </a>
  
    <nav class="md-nav" aria-label="How Continuous Integration ("CI") is configured">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coverage" class="md-nav__link">
    Coverage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#valgrind-and-ruby_memcheck" class="md-nav__link">
    Valgrind and ruby_memcheck
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helpful-hints-when-writing-new-ci-jobs" class="md-nav__link">
    Helpful hints when writing new CI jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-releases" class="md-nav__link">
    Packaging releases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-utilities" class="md-nav__link">
    Other utilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bumping-java-dependencies" class="md-nav__link">
    Bumping Java dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rake-tasks" class="md-nav__link">
    Rake tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-release" class="md-nav__link">
    Making a release
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-of-conduct" class="md-nav__link">
    Code of Conduct
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="contributing-to-nokogiri">Contributing to Nokogiri<a class="headerlink" href="#contributing-to-nokogiri" title="Permanent link">&para;</a></h1>
<p>This doc is intended to be a short introduction on how to modify and maintain Nokogiri.</p>
<p>If you're looking for guidance on filing a bug report or getting support, please visit the <a href="http://www.nokogiri.org/tutorials/getting_help.html">"Getting Help" tutorial</a> at the <a href="http://nokogiri.org">nokogiri.org</a> site.</p>
<h2 id="contents">Contents<a class="headerlink" href="#contents" title="Permanent link">&para;</a></h2>
<!-- regenerate TOC with `rake format:toc` -->

<!-- toc -->

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#some-guiding-principles-of-the-project">Some guiding principles of the project</a></li>
<li><a href="#where-to-start-getting-involved">Where to start getting involved</a></li>
<li><a href="#submitting-pull-requests">Submitting Pull Requests</a></li>
<li><a href="#branch-management-and-release-management">Branch Management and Release Management</a></li>
<li><a href="#how-to-set-up-your-local-development-environment">How to set up your local development environment</a></li>
<li><a href="#how-to-run-the-tests">How to run the tests</a></li>
<li><a href="#style-guide">Style Guide</a></li>
<li><a href="#how-continuous-integration-ci-is-configured">How Continuous Integration ("CI") is configured</a></li>
<li><a href="#packaging-releases">Packaging releases</a></li>
<li><a href="#other-utilities">Other utilities</a></li>
<li><a href="#bumping-java-dependencies">Bumping Java dependencies</a></li>
<li><a href="#rake-tasks">Rake tasks</a></li>
<li><a href="#making-a-release">Making a release</a></li>
<li><a href="#code-of-conduct">Code of Conduct</a></li>
</ul>
<!-- tocstop -->

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Hello there! I'm super excited that you're interested in contributing to Nokogiri. Welcome!</p>
<p>This document is intended only to provide a brief introduction on how to contribute to Nokogiri. It's not a complete specification of everything you need to know, so if you want to know more, I encourage you to reach out to the maintainers via email, twitter, or a new Github issue. We'd love to get to know you a bit better!</p>
<h2 id="some-guiding-principles-of-the-project">Some guiding principles of the project<a class="headerlink" href="#some-guiding-principles-of-the-project" title="Permanent link">&para;</a></h2>
<p>The top guiding principles, as noted in the README are:</p>
<ul>
<li>be secure-by-default by treating all documents as <strong>untrusted</strong> by default</li>
<li>be a <strong>thin-as-reasonable layer</strong> on top of the underlying parsers, and don't attempt to fix behavioral differences between the parsers</li>
</ul>
<p>Nokogiri supports both CRuby and JRuby, and has native code specific to each (though much Ruby code is shared between them). Some related secondary principles are:</p>
<ul>
<li>Whenever possible, implement the same functionality for both CRuby and JRuby.</li>
<li>Whenever possible, implement shared behavior as shared Ruby code (i.e., write as little native code as reasonable).</li>
<li>Whenever possible, avoid writing tests that are platform-specific (but if you do, use <code>skip</code> to provide an explanation).</li>
</ul>
<p>Notably, despite all parsers being standards-compliant, there are behavioral inconsistencies between the parsers used in the CRuby and JRuby implementations, and Nokogiri does not and should not attempt to remove these inconsistencies. Instead, we surface these differences in the test suite when they are important/semantic; or we intentionally write tests to depend only on the important/semantic bits (omitting whitespace from regex matchers on results, for example).</p>
<p>Nokogiri is widely used in the Ruby ecosystem, and so extra care should be taken to avoid introducing breaking changes. Please read our <a href="https://nokogiri.org/index.html#semantic-versioning-policy">Semantic Versioning Policy</a> to understand what we consider to be a breaking change.</p>
<h2 id="where-to-start-getting-involved">Where to start getting involved<a class="headerlink" href="#where-to-start-getting-involved" title="Permanent link">&para;</a></h2>
<p>Please take a look at our <a href="https://github.com/sparklemotion/nokogiri/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22">Issues marked "Help Wanted"</a>.</p>
<p>Also, <a href="#documentation">pull requests for documentation improvements are always welcome</a>!</p>
<h2 id="submitting-pull-requests">Submitting Pull Requests<a class="headerlink" href="#submitting-pull-requests" title="Permanent link">&para;</a></h2>
<p>Pull requests should be made with <code>main</code> as the merge base. See the next section for details.</p>
<p><strong>Pull requests that introduce behavior change must always contain a test</strong> demonstrating the behavior being introduced, fixed, or changed. These tests should ideally communicate to the maintainers the problem being solved. We will ask you for clarification if we don't understand the problem you're trying to solve.</p>
<p>If the pull request contains a feature or a bugfix, please make sure to create a CHANGELOG entry in the "unreleased" section.</p>
<p>Please do not submit pull requests that make purely cosmetic changes to the code (style, naming, etc.). While we recognize that the code can always be improved, we prefer that you focus on more impactful contributions.</p>
<p>Feel free to push a "work in progress" to take advantage of the feedback loops from CI. But then please indicate that it's still in progress by marking it as a <a href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests#draft-pull-requests">Draft Pull Request</a>.</p>
<h2 id="branch-management-and-release-management">Branch Management and Release Management<a class="headerlink" href="#branch-management-and-release-management" title="Permanent link">&para;</a></h2>
<p>Nokogiri follows SemVer, and some nuances of that policy are spelled out in <a href="https://nokogiri.org/index.html#semantic-versioning-policy">Semantic Versioning Policy</a>.</p>
<p>Development should be happening on <code>main</code>, which sets <code>Nokogiri::VERSION</code> to a development version of the next minor release (e.g., <code>"1.14.0.dev"</code>). All pull requests should have <code>main</code> as the merge base.</p>
<p>Patch releases should be made by cherry-picking commits from <code>main</code> onto the release branch (e.g., <code>v1.13.x</code>) in a pull request labeled <code>backport</code>.</p>
<h2 id="how-to-set-up-your-local-development-environment">How to set up your local development environment<a class="headerlink" href="#how-to-set-up-your-local-development-environment" title="Permanent link">&para;</a></h2>
<h3 id="basic">Basic<a class="headerlink" href="#basic" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>git clone --recurse-submodules https://github.com/sparklemotion/nokogiri
bundle install
</code></pre></div>
<h3 id="advanced">Advanced<a class="headerlink" href="#advanced" title="Permanent link">&para;</a></h3>
<p>Please install the latest or previous version of CRuby (e.g., 3.1 or 3.0 as of 2022-01), and a recent version of JRuby. We recommend using <code>rbenv</code>, which is used in test scripts when necessary to test gems against multiple rubies.</p>
<p>Please install a system version of libxml2/libxslt (see <a href="https://nokogiri.org/tutorials/installing_nokogiri.html#installing-using-standard-system-libraries">Installing Nokogiri</a> for details) so that you can test against both the packaged libraries and your system libraries.</p>
<p>We recommend that you install <code>valgrind</code> if you can, but it's only necessary for debugging problems so feel free to wait until you need it. (I'm not sure valgrind is easily available on MacOS.)</p>
<p>If you plan to package precompiled native gems, make sure <code>docker</code> is installed and is working properly.</p>
<h2 id="how-to-run-the-tests">How to run the tests<a class="headerlink" href="#how-to-run-the-tests" title="Permanent link">&para;</a></h2>
<p>Note that <code>rake test</code> does not compile the native extension, and this is intentional (so we can run the test suite against an installed gem). If you're modifying the extension code, please make sure you re-compile each time you run the tests to ensure you're testing your changes.</p>
<h3 id="the-short-version">The short version<a class="headerlink" href="#the-short-version" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>
</code></pre></div>
<h3 id="cruby-advanced-usage">CRuby advanced usage<a class="headerlink" href="#cruby-advanced-usage" title="Permanent link">&para;</a></h3>
<p>Test using your system's libraries:</p>
<div class="highlight"><pre><span></span><code>bundle <span class="nb">exec</span> rake clean  <span class="c1">#  blow away pre-existing libraries using packaged libs</span>
bundle <span class="nb">exec</span> rake compile <span class="nb">test</span> -- --enable-system-libraries
</code></pre></div>
<p>Run tests using valgrind:</p>
<div class="highlight"><pre><span></span><code>bundle <span class="nb">exec</span> rake compile test:valgrind
</code></pre></div>
<p>Run tests in the debugger:</p>
<div class="highlight"><pre><span></span><code>bundle <span class="nb">exec</span> rake compile test:gdb
<span class="c1"># or</span>
bundle <span class="nb">exec</span> rake compile test:lldb
</code></pre></div>
<p>Run tests and look for new memory leaks:</p>
<div class="highlight"><pre><span></span><code>bundle <span class="nb">exec</span> rake compile test:memcheck
</code></pre></div>
<p>Note that by default the test suite will run a major GC after each test completes. This has shown to be useful for localizing some classes of memory bugs, but does slow the suite down. Some variations of the test suite behavior are available (see <code>test/helper.rb</code> for more info):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># see failure messages immediately</span>
<span class="nv">NOKOGIRI_TEST_FAIL_FAST</span><span class="o">=</span>t bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>

<span class="c1"># ordinary GC behavior</span>
<span class="nv">NOKOGIRI_TEST_GC_LEVEL</span><span class="o">=</span>normal bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>

<span class="c1"># minor GC after each test</span>
<span class="nv">NOKOGIRI_TEST_GC_LEVEL</span><span class="o">=</span>minor bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>

<span class="c1"># major GC after each test</span>
<span class="nv">NOKOGIRI_TEST_GC_LEVEL</span><span class="o">=</span>major bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>

<span class="c1"># major GC after each test and GC compaction after every 20 tests</span>
<span class="nv">NOKOGIRI_TEST_GC_LEVEL</span><span class="o">=</span>compact bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>

<span class="c1"># verify references after compaction after every 20 tests</span>
<span class="c1"># (see https://alanwu.space/post/check-compaction/)</span>
<span class="nv">NOKOGIRI_TEST_GC_LEVEL</span><span class="o">=</span>verify bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>

<span class="c1"># run with GC &quot;stress mode&quot; on</span>
<span class="nv">NOKOGIRI_TEST_GC_LEVEL</span><span class="o">=</span>stress bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>
</code></pre></div>
<h3 id="libxml2-advanced-usage">libxml2 advanced usage<a class="headerlink" href="#libxml2-advanced-usage" title="Permanent link">&para;</a></h3>
<p>If you want to build Nokogiri against a modified version of libxml2, clone libxml2 to <code>../libxml2</code> and then run <code>scripts/compile-against-libxml2-source</code>.</p>
<p>That script also takes an optional command to run with the proper environment variables set to use the local libxml2 library, which can be useful when trying to <code>git bisect</code> against libxml2.</p>
<h3 id="gumbo-html5-parser">gumbo HTML5 parser<a class="headerlink" href="#gumbo-html5-parser" title="Permanent link">&para;</a></h3>
<p>To run the test suite for the gumbo parser:</p>
<div class="highlight"><pre><span></span><code>bundle <span class="nb">exec</span> rake gumbo
</code></pre></div>
<p>Please note that additional html5lib tests for Nokogiri's HTML5 parser exist in a submodule. If you haven't checked that submodule out, here's how to do so:</p>
<div class="highlight"><pre><span></span><code>git submodule update --init  <span class="c1">#  test/html5lib-tests</span>
bundle <span class="nb">exec</span> rake compile <span class="nb">test</span>
</code></pre></div>
<h2 id="style-guide">Style Guide<a class="headerlink" href="#style-guide" title="Permanent link">&para;</a></h2>
<h3 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h3>
<p>We use <code>rdoc</code> to build Nokogiri's documentation. Run <code>rake rdoc</code> to build into the <code>./html</code> directory, and see the rdoc tasks in <a href="rakelib/rdoc.rake">rakelib/rdoc.rake</a>.</p>
<p>Previously we made some effort to move towards <code>yard</code> but that work was stopped (and the decision record can be found at <a href="https://github.com/sparklemotion/nokogiri/issues/1996">RFC: convert to use <code>yard</code> for documentation</a>).</p>
<p>Docstrings should be in <code>RDoc::Markup</code> format, though simple docstrings may be in Markdown (using <code>:markup: markdown</code>).</p>
<p>If you submit pull requests that improve documentation, <strong>I will happily merge them</strong> and credit you in the CHANGELOG.</p>
<p>Some guidelines (see <a href="lib/nokogiri/xml/node.rb">lib/nokogiri/xml/node.rb</a> and <a href="ext/nokogiri/xml/node.c">ext/nokogiri/xml/node.c</a> for examples):</p>
<ul>
<li>Use <code>:call-seq:</code> to ...</li>
<li>note the return type of the method whenever possible, e.g. <code>:call-seq: upcase(name) â†’ String</code></li>
<li>name all the aliases of a method</li>
<li>indicate block/yield usage of a method</li>
<li>Briefly explain the purpose of the method, what it returns, and what side effects it has</li>
<li>Use a <code>[Parameters]</code> definition to note the expected types of all the parameters as a bulleted list</li>
<li>Use a <code>[Returns]</code> definition to note the return type</li>
<li>Use a <code>[Yields]</code> definition to note the block parameters</li>
<li>Use a <code>âš </code> character to warn the user about tricky usage</li>
<li>Use a <code>ðŸ’¡</code> character to call attention to important notes</li>
<li><code>See also:</code> should be used to call out related methods</li>
<li><code>Since</code> should be used to indicate the version in which the code was introduced</li>
<li>Prefer to <strong>show</strong> nuanced behavior in code examples, rather than try to explain it in prose.</li>
</ul>
<h3 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h3>
<p>I don't feel very strongly about code style, but this project follows <a href="https://shopify.github.io/ruby-style-guide/">Shopify's Ruby Style Guide</a>, and for C and Java code the project uses the <code>astyle</code> configuration laid out in <code>/rakelib/format.rake</code>.</p>
<p>You can auto-format the C, Java, and Ruby code with <code>rake format</code>.</p>
<p>There are some pending Rubocop rules in <code>.rubocop_todo.yml</code>. If you'd like to fix them up, I will happily merge your pull request.</p>
<p>No, I don't want to debate any of the style choices.</p>
<h2 id="how-continuous-integration-ci-is-configured">How Continuous Integration ("CI") is configured<a class="headerlink" href="#how-continuous-integration-ci-is-configured" title="Permanent link">&para;</a></h2>
<p>The bulk of CI is running in Github Actions since May 2021: <a href="https://github.com/sparklemotion/nokogiri/actions">https://github.com/sparklemotion/nokogiri/actions</a></p>
<p>However, we also run tests against 32-bit windows (which aren't supported by GA as of this writing) in Appveyor: <a href="https://ci.appveyor.com/project/flavorjones/nokogiri">https://ci.appveyor.com/project/flavorjones/nokogiri</a></p>
<p>A known hole in CI coverage is the lack native gem tests for arm64-darwin.</p>
<h3 id="coverage">Coverage<a class="headerlink" href="#coverage" title="Permanent link">&para;</a></h3>
<p>The <code>ci.yml</code> pipeline includes jobs to:</p>
<ul>
<li>basic security sanity check and formatting check, using Rubocop</li>
<li>fast feedback for obvious failures: run against system libraries on vanilla ubuntu</li>
<li>run the Gumbo parser tests on ubuntu, macos, and windows</li>
<li>run on all supported versions of CRuby:<ul>
<li>once with packaged libraries</li>
<li>once with system libraries</li>
<li>once on valgrind (to look for memory bugs)</li>
</ul>
</li>
<li>run the test suite looking for new memory leaks (using ruby_memcheck)</li>
<li>run on JRuby</li>
<li>run on a Musl (Alpine) system:<ul>
<li>against system libraries</li>
<li>with valgrind using packaged libraries</li>
</ul>
</li>
<li>run with libxml-ruby loaded (because this can interact with libxml2 in conflicting ways)<ul>
<li>against system libraries</li>
<li>with valgrind using packaged libraries</li>
</ul>
</li>
</ul>
<p>The <code>upstream.yml</code> pipeline includes jobs to:</p>
<ul>
<li>run against libxml2 and libxslt head (linux), including a valgrind check</li>
<li>run against CRuby head (linux, windows, macos) including a valgrind check</li>
<li>run against JRuby head</li>
<li>run html5lib-tests from that project's <code>origin/master</code></li>
</ul>
<p>The <code>gem-install.yml</code> pipeline includes jobs to:</p>
<ul>
<li>build a "ruby" platform gem<ul>
<li>install and test on linux, macos, and windows</li>
</ul>
</li>
<li>build native gems<ul>
<li>install and test against all supported versions of CRuby</li>
<li>install and test on a variety of linux, macos, and windows systems</li>
</ul>
</li>
<li>build a jruby gem, install and test it</li>
</ul>
<p>The <code>truffle.yml</code> pipeline tests TruffleRuby nightlies with a few different compile-time flags. TruffleRuby support is still experimental due to Sulong limitations, and the test suite is exceedingly slow when run by TR, so this pipeline doesn't run on pushes or pull requests. Instead, it runs periodically on a timer to give us some signal without slowing down developer feedback loops.</p>
<p>The <code>generate-ci-images.yml</code> pipeline builds some containers used by the other pipelines once a week. This is primarily an optimization to make sure system packages (like <code>libxml2-dev</code> and <code>valgrind</code>) are already installed. See <code>oci-images/nokogiri-test/</code> for details on what's in these containers.</p>
<h3 id="valgrind-and-ruby_memcheck">Valgrind and <code>ruby_memcheck</code><a class="headerlink" href="#valgrind-and-ruby_memcheck" title="Permanent link">&para;</a></h3>
<p>We rely heavily on Valgrind and <a href="https://github.com/Shopify/ruby_memcheck"><code>ruby_memcheck</code></a> to catch memory bugs by running in combination with every version of CRuby.</p>
<p>We use suppressions primarily to quiet known small memory leaks or quirks of certain Ruby versions. See the files in the <code>/suppressions</code> directory and <code>/rakelib/test.rake</code> for more information.</p>
<h3 id="helpful-hints-when-writing-new-ci-jobs">Helpful hints when writing new CI jobs<a class="headerlink" href="#helpful-hints-when-writing-new-ci-jobs" title="Permanent link">&para;</a></h3>
<ul>
<li>Always checkout the source code <strong>including submodules</strong> (for the html5lib tests)</li>
<li>When testing packaged libraries (not system libraries), cache either <code>ports/</code> (for compiled libraries) or <code>ports/archives/</code> (for just tarballs)</li>
<li>note that <code>libgumbo</code> is built outside of <code>ports/</code> to allow us to do this caching safely</li>
</ul>
<h2 id="packaging-releases">Packaging releases<a class="headerlink" href="#packaging-releases" title="Permanent link">&para;</a></h2>
<p>As a prerequisite please make sure you have <code>docker</code> correctly installed, to build native (precompiled) gems.</p>
<p>Run <code>scripts/build-gems</code> which will package gems for all supported platforms, and run some basic sanity tests on those packages using <code>scripts/test-gem-set</code>, <code>scripts/test-gem-file-contents</code>, and <code>scripts/test-gem-installation</code>.</p>
<h2 id="other-utilities">Other utilities<a class="headerlink" href="#other-utilities" title="Permanent link">&para;</a></h2>
<p><code>scripts/test-exported-symbols</code> checks the compiled <code>nokogiri.so</code> library for surprising exported symbols. This script likely only works on Linux, sorry.</p>
<p><code>scripts/test-nokogumbo-compatibility</code> is used by CI to ensure that Nokogumbo installs correctly against the currently-installed version of Nokogiri. Nokogumbo receives this extra care because it compiles against Nokogiri's and libxml2's header files, and makes assumptions about what symbols are exported by Nokogiri's extension library.</p>
<p><code>scripts/files-modified-by-open-prs</code> is a hack to see what files are being proposed to change in the set of open pull requests. This might be useful if you're thinking about radically changing a file, to be aware of what merge conflicts might result. This could probably be a rake task.</p>
<p>There's a <code>Vagrantfile</code> in the project root which I've used once or twice to try to reproduce problems non-Linux systems (like OpenBSD). It's not well-maintained so YMMV.</p>
<h2 id="bumping-java-dependencies">Bumping Java dependencies<a class="headerlink" href="#bumping-java-dependencies" title="Permanent link">&para;</a></h2>
<p>Java dependencies, in the form of <code>.jar</code> files, are all vendored as part of the <code>java</code> platform gem.</p>
<p>We use <a href="https://github.com/mkristian/jar-dependencies"><code>jar-dependencies</code></a> as a development dependency to manage the project's Java dependencies, with the current exception of:</p>
<ul>
<li>nekohtml, forked in <a href="https://github.com/sparklemotion/nokogiri/commit/6166964"><code>6166964</code></a> for a few issues in v1.6.8, lives at <a href="https://github.com/jvshahid/nekohtml">https://github.com/jvshahid/nekohtml</a></li>
<li>nekodtd, forked to solve <a href="https://github.com/sparklemotion/nokogiri/issues/547">#547</a>, lives at <a href="https://github.com/jvshahid/nekodtd">https://github.com/jvshahid/nekodtd</a></li>
</ul>
<p>To modify or add a dependency, a few things needs to be in sync:</p>
<ul>
<li><code>nokogiri.gemspec</code>: <code>spec.requirements</code> need to specify the maven group Id, artifact ID, and version</li>
<li><code>nokogiri.gemspec</code>: <code>spec.files</code> need to include the jar files</li>
<li>git: the jar files under <code>lib/nokogiri/jruby/</code> need to be committed to git</li>
<li><code>lib/nokogiri/jruby/nokogiri_jars.rb</code>: needs to include all the jars</li>
</ul>
<p>A quick summary of what this looks like for you, the developer:</p>
<ul>
<li>edit the <code>requirements</code> in the gemspec</li>
<li>run <code>bundle exec rake vendor_jars</code> which updates everything under <code>lib/nokogiri/jruby</code></li>
<li>run <code>bundle exec check_manifest</code> and if necessary update the gemspec <code>files</code></li>
<li>make sure to check everything under <code>lib/nokogiri/jruby</code> into git, including the jar files</li>
</ul>
<h2 id="rake-tasks">Rake tasks<a class="headerlink" href="#rake-tasks" title="Permanent link">&para;</a></h2>
<p>The <code>Rakefile</code> used to be a big fat mess. It's now decomposed into a small set of files in <code>/rakelib</code>. If you've got a new rake task you'd like to introduce, please consider whether it belongs in one of the existing concerns, or needs a new file. Please don't add it to <code>Rakefile</code> without compelling reasons.</p>
<h2 id="making-a-release">Making a release<a class="headerlink" href="#making-a-release" title="Permanent link">&para;</a></h2>
<p>A quick checklist:</p>
<ul>
<li>[ ] make sure CI is green!</li>
<li>[ ] update <code>CHANGELOG.md</code> and <code>lib/nokogiri/version/constant.rb</code></li>
<li>[ ] create a git tag</li>
<li>[ ] run <code>scripts/build-gems</code> and make sure it completes and all the tests pass</li>
<li>[ ] <code>for g in gems/*.gem ; do gem push $g ; done</code></li>
<li>[ ] create a release at <a href="https://github.com/sparklemotion/nokogiri/releases">https://github.com/sparklemotion/nokogiri/releases</a> and provide sha2 checksums</li>
<li>[ ] if security-related, email <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#117;&#98;&#121;&#45;&#115;&#101;&#99;&#117;&#114;&#105;&#116;&#121;&#45;&#97;&#110;&#110;&#64;&#103;&#111;&#111;&#103;&#108;&#101;&#103;&#114;&#111;&#117;&#112;&#115;&#46;&#99;&#111;&#109;">&#114;&#117;&#98;&#121;&#45;&#115;&#101;&#99;&#117;&#114;&#105;&#116;&#121;&#45;&#97;&#110;&#110;&#64;&#103;&#111;&#111;&#103;&#108;&#101;&#103;&#114;&#111;&#117;&#112;&#115;&#46;&#99;&#111;&#109;</a> and <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#117;&#98;&#121;&#45;&#116;&#97;&#108;&#107;&#64;&#114;&#117;&#98;&#121;&#45;&#108;&#97;&#110;&#103;&#46;&#111;&#114;&#103;">&#114;&#117;&#98;&#121;&#45;&#116;&#97;&#108;&#107;&#64;&#114;&#117;&#98;&#121;&#45;&#108;&#97;&#110;&#103;&#46;&#111;&#114;&#103;</a></li>
<li>[ ] update nokogiri.org</li>
<li>[ ] bump <code>lib/nokogiri/version/constant.rb</code> to a prerelease version like <code>v1.14.0.dev</code></li>
</ul>
<h2 id="code-of-conduct">Code of Conduct<a class="headerlink" href="#code-of-conduct" title="Permanent link">&para;</a></h2>
<p>Our full Code of Conduct is in <a href="CODE_OF_CONDUCT.html"><code>CODE_OF_CONDUCT.md</code></a>.</p>
<p>For best results, be nice. Remember that Nokogiri maintainers are volunteers, and treat them with respect.</p>
<p>Do not act entitled to service. Do not be rude. Do not use judgmental or foul language.</p>
<p>The maintainers reserve the right to delete issues or comments that are rude, or that contain foul language, and will permanently block users who violate the code.</p>

  




              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-top--hidden md-icon" data-md-component="top">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="CHANGELOG.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Changelog" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Changelog
            </div>
          </div>
        </a>
      
      
        
        <a href="CODE_OF_CONDUCT.html" class="md-footer__link md-footer__link--next" aria-label="Next: Code of Conduct" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Code of Conduct
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright â’¸ 2009-2021 Mike Dalessio
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/sparklemotion/nokogiri.org" target="_blank" rel="noopener" title="sparklemotion/nokogiri.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  

<h4>Cookie consent</h4>
<p>This site uses cookies to measure the effectiveness of our documentation and whether users
find what they're searching for. With your consent, you're helping us to make our
documentation better.
</p>
<input type="checkbox" class="md-toggle" id="__settings">
<div class="md-consent__settings">
  <ul class="task-list">
    
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  <label class="md-button" for="__settings">Manage settings</label>
  <button class="md-button md-button--primary">Accept</button>
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var form=document.forms.consent;form.addEventListener("submit",function(n){n.preventDefault(),__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(n){return[n,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.e72f9a50.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.568b24b3.min.js"></script>
      
    
  </body>
</html>