<!DOCTYPE html>
<html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Nokogiri::XSLT::Stylesheet
  
    — Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css">

  <link rel="stylesheet" href="../../css/common.css" type="text/css">

<script type="text/javascript">
  pathId = "Nokogiri::XSLT::Stylesheet";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


      <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1260604-8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-1260604-8');
    </script>
</head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (S)</a> »
    <span class="title"><span class="object_link"><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span></span> » <span class="title"><span class="object_link"><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span></span>
     » 
    <span class="title">Stylesheet</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link" href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content">
<h1>Class: Nokogiri::XSLT::Stylesheet
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Nokogiri::XSLT::Stylesheet</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/nokogiri/xslt/stylesheet.rb<span class="defines">,<br>
  ext/nokogiri/xslt_stylesheet.c</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    
<p>A Stylesheet represents an XSLT Stylesheet object.  Stylesheet creation is done through Nokogiri.XSLT.  Here is an example of transforming an XML::Document with a Stylesheet:</p>

<pre class="code ruby"><code class="ruby"><span class="id identifier rubyid_doc">doc</span>   <span class="op">=</span> <span class="const"><span class="object_link"><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span></span><span class="lparen">(</span><span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_read">read</span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">some_file.xml</span><span class="tstring_end">'</span></span><span class="rparen">)</span><span class="rparen">)</span>
<span class="id identifier rubyid_xslt">xslt</span>  <span class="op">=</span> <span class="const"><span class="object_link"><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span></span><span class="lparen">(</span><span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_read">read</span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">some_transformer.xslt</span><span class="tstring_end">'</span></span><span class="rparen">)</span><span class="rparen">)</span>

<span class="id identifier rubyid_puts">puts</span> <span class="id identifier rubyid_xslt">xslt</span><span class="period">.</span><span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_doc">doc</span><span class="rparen">)</span>
</code></pre>

<p>See Nokogiri::XSLT::Stylesheet#transform for more transformation information.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_stylesheet_doc-class_method" title="parse_stylesheet_doc (class method)">.<strong>parse_stylesheet_doc</strong>(document)  ⇒ Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class="inline">
<p>Parse a stylesheet from <code>document</code>.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#apply_to-instance_method" title="#apply_to (instance method)">#<strong>apply_to</strong>(document, params = [])  ⇒ Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class="inline">
<p>Apply an XSLT stylesheet to an XML::Document.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#serialize-instance_method" title="#serialize (instance method)">#<strong>serialize</strong>(document)  ⇒ Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class="inline">
<p>Serialize <code>document</code> to an xml string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#transform-instance_method" title="#transform (instance method)">#<strong>transform</strong>(document, params = [])  ⇒ Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class="inline">
<p>Apply an XSLT stylesheet to an XML::Document.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="parse_stylesheet_doc-class_method">
  
    .<strong>parse_stylesheet_doc</strong>(document)  ⇒ <tt>Object</tt> 
  

  

  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Parse a stylesheet from <code>document</code>.</p>


  </div>
</div>
<div class="tags">
  
  


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/nokogiri/xslt_stylesheet.c', line 60</span>

static VALUE
parse_stylesheet_doc(VALUE klass, VALUE xmldocobj)
{
  xmlDocPtr xml, xml_cpy;
  VALUE errstr, exception;
  xsltStylesheetPtr ss ;
  Data_Get_Struct(xmldocobj, xmlDoc, xml);
  exsltRegisterAll();

  errstr = rb_str_new(0, 0);
  xsltSetGenericErrorFunc((void *)errstr, xslt_generic_error_handler);

  xml_cpy = xmlCopyDoc(xml, 1); /* 1 =&gt; recursive */
  ss = xsltParseStylesheetDoc(xml_cpy);

  xsltSetGenericErrorFunc(NULL, NULL);

  if (!ss) {
    xmlFreeDoc(xml_cpy);
    exception = rb_exc_new3(rb_eRuntimeError, errstr);
    rb_exc_raise(exception);
  }

  return Nokogiri_wrap_xslt_stylesheet(ss);
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="apply_to-instance_method">
  
    #<strong>apply_to</strong>(document, params = [])  ⇒ <tt>Object</tt> 
  

  

  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Apply an XSLT stylesheet to an XML::Document. <code>params</code> is an array of strings used as XSLT parameters. returns serialized document</p>


  </div>
</div>
<div class="tags">
  

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nokogiri/xslt/stylesheet.rb', line 21</span>

<span class="kw">def</span> <span class="id identifier rubyid_apply_to">apply_to</span> <span class="id identifier rubyid_document">document</span><span class="comma">,</span> <span class="id identifier rubyid_params">params</span> <span class="op">=</span> <span class="lbracket">[</span><span class="rbracket">]</span>
  <span class="id identifier rubyid_serialize">serialize</span><span class="lparen">(</span><span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_document">document</span><span class="comma">,</span> <span class="id identifier rubyid_params">params</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="serialize-instance_method">
  
    #<strong>serialize</strong>(document)  ⇒ <tt>Object</tt> 
  

  

  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Serialize <code>document</code> to an xml string.</p>


  </div>
</div>
<div class="tags">
  
  


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/nokogiri/xslt_stylesheet.c', line 93</span>

static VALUE
serialize(VALUE self, VALUE xmlobj)
{
  xmlDocPtr xml ;
  nokogiriXsltStylesheetTuple *wrapper;
  xmlChar *doc_ptr ;
  int doc_len ;
  VALUE rval ;

  Data_Get_Struct(xmlobj, xmlDoc, xml);
  Data_Get_Struct(self, nokogiriXsltStylesheetTuple, wrapper);
  xsltSaveResultToString(&amp;doc_ptr, &amp;doc_len, xml, wrapper-&gt;ss);
  rval = NOKOGIRI_STR_NEW(doc_ptr, doc_len);
  xmlFree(doc_ptr);
  return rval ;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="transform-instance_method">
  
    #<strong>transform</strong>(document, params = [])  ⇒ <tt>Object</tt> 
  

  

  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Apply an XSLT stylesheet to an XML::Document. <code>params</code> is an array of strings used as XSLT parameters. returns Nokogiri::XML::Document</p>

<p>Example:</p>

<pre class="code"><code class=""><span class="id identifier rubyid_doc">doc</span>   <span class="op">=</span> <span class="const"><span class="object_link"><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="../XML.html" title="Nokogiri::XML (module)">XML</a></span></span><span class="lparen">(</span><span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_read">read</span><span class="lparen">(</span><span class="const">ARGV</span><span class="lbracket">[</span><span class="int">0</span><span class="rbracket">]</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="id identifier rubyid_xslt">xslt</span>  <span class="op">=</span> <span class="const"><span class="object_link"><a href="../../Nokogiri.html" title="Nokogiri (module)">Nokogiri</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="../XSLT.html" title="Nokogiri::XSLT (module)">XSLT</a></span></span><span class="lparen">(</span><span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_read">read</span><span class="lparen">(</span><span class="const">ARGV</span><span class="lbracket">[</span><span class="int">1</span><span class="rbracket">]</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="id identifier rubyid_puts">puts</span> <span class="id identifier rubyid_xslt">xslt</span><span class="period">.</span><span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_doc">doc</span><span class="comma">,</span> <span class="lbracket">[</span><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">key</span><span class="tstring_end">'</span></span><span class="comma">,</span> <span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">value</span><span class="tstring_end">'</span></span><span class="rbracket">]</span><span class="rparen">)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
  


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/nokogiri/xslt_stylesheet.c', line 125</span>

static VALUE
transform(int argc, VALUE *argv, VALUE self)
{
  VALUE xmldoc, paramobj, errstr, exception ;
  xmlDocPtr xml ;
  xmlDocPtr result ;
  nokogiriXsltStylesheetTuple *wrapper;
  const char **params ;
  long param_len, j ;
  int parse_error_occurred ;

  rb_scan_args(argc, argv, "11", &amp;xmldoc, &amp;paramobj);
  if (NIL_P(paramobj)) { paramobj = rb_ary_new2(0L) ; }
  if (!rb_obj_is_kind_of(xmldoc, cNokogiriXmlDocument)) {
    rb_raise(rb_eArgError, "argument must be a Nokogiri::XML::Document");
  }

  /* handle hashes as arguments. */
  if (T_HASH == TYPE(paramobj)) {
    paramobj = rb_funcall(paramobj, rb_intern("to_a"), 0);
    paramobj = rb_funcall(paramobj, rb_intern("flatten"), 0);
  }

  Check_Type(paramobj, T_ARRAY);

  Data_Get_Struct(xmldoc, xmlDoc, xml);
  Data_Get_Struct(self, nokogiriXsltStylesheetTuple, wrapper);

  param_len = RARRAY_LEN(paramobj);
  params = calloc((size_t)param_len + 1, sizeof(char *));
  for (j = 0 ; j &lt; param_len ; j++) {
    VALUE entry = rb_ary_entry(paramobj, j);
    const char *ptr = StringValueCStr(entry);
    params[j] = ptr;
  }
  params[param_len] = 0 ;

  errstr = rb_str_new(0, 0);
  xsltSetGenericErrorFunc((void *)errstr, xslt_generic_error_handler);
  xmlSetGenericErrorFunc((void *)errstr, xslt_generic_error_handler);

  result = xsltApplyStylesheet(wrapper-&gt;ss, xml, params);
  free(params);

  xsltSetGenericErrorFunc(NULL, NULL);
  xmlSetGenericErrorFunc(NULL, NULL);

  parse_error_occurred = (Qfalse == rb_funcall(errstr, rb_intern("empty?"), 0));

  if (parse_error_occurred) {
    exception = rb_exc_new3(rb_eRuntimeError, errstr);
    rb_exc_raise(exception);
  }

  return noko_xml_document_wrap((VALUE)0, result) ;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Mar 13 12:01:25 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>
